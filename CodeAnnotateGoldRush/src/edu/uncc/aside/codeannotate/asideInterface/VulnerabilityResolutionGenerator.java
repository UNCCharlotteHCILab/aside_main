package edu.uncc.aside.codeannotate.asideInterface;


import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.LinkedList;
import java.util.List;
import java.util.Random;

import org.eclipse.core.resources.IMarker;
import org.eclipse.core.resources.IProject;
import org.eclipse.core.runtime.CoreException;
import org.eclipse.jdt.core.ICompilationUnit;
import org.eclipse.swt.custom.StyledText;
import org.eclipse.ui.IEditorPart;
import org.eclipse.ui.IMarkerResolution;
import org.eclipse.ui.IMarkerResolutionGenerator;
import org.eclipse.ui.IMarkerResolutionGenerator2;
import org.eclipse.ui.IViewPart;
import org.eclipse.ui.PartInitException;

	public class VulnerabilityResolutionGenerator  implements
			IMarkerResolutionGenerator, IMarkerResolutionGenerator2
	{
		public IMarkerResolution[] getResolutions(IMarker mk) 
		{
			//handle highlighting
			InterfaceUtil.clearAndSetHighlighting(3, mk);
			
			//get marker code for faking a vulnerability for ui study, 1 is the first vulnerability, 2 is the second
			
			int markerIdentifier = mk.getAttribute("markerIdentifier", -1);
			
			System.out.println("MarkerIdentifier " + markerIdentifier);
			
		       try {
		          Object problem = mk.getAttribute("WhatsUp");
		          
		          problem = "";
		          
		          return new IMarkerResolution[] 
		        {
		        	new VulnerabilityTitleResolution("*****ASIDE POTENTIAL SECURITY VULNERABILITY*****" + problem, markerIdentifier),
		        	new VulnerabilityResolution("Allow Alphabetical Characters and Numbers"),
		        	new VulnerabilityResolution("Allow Minimal HTTP Characters"),
		        	new VulnerabilityResolution("Allow URL Characters"),
		        	new VulnerabilityResolution("Allow Credit Card Numbers"),
		        	new VulnerabilityResolution("Allow EMail Addresses"),
		        	new VulnerabilityResolution("Allow Social Security Numbers")
		             /*new VulnerabilityTitleResolution("**********ASIDE Potential Vulnerability Detected**********"+problem, markerIdentifier),
		             new VulnerabilityResolution("Delete Annotation"+problem),
		             new VulnerabilityResolution("Modify Annotation"+problem),
		             new VulnerabilityReadMore("Read More"+problem),
		             new AnnotateNowResolution("Annotate Now"+problem, "red.flag"),*/
		        	
		        		  
		          };
		       }
		       catch (CoreException e) 
		       {
		          return new IMarkerResolution[0];
		       }
		       
		    }

		@Override
		public boolean hasResolutions(IMarker arg0) 
		{
			// TODO Auto-generated method stub
			return true;
		}	
}
